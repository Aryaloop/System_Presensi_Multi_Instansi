import{b as C,r as l,u as A,j as e,a as d,S as s}from"./index-CMRaJyvN.js";function B(){const g=C(),[r,u]=l.useState(1),[b,c]=l.useState(!1),[t,i]=l.useState(null),[f,y]=l.useState([]),h=20,x=a=>{const n=[];return a.is_senin&&n.push("Sen"),a.is_selasa&&n.push("Sel"),a.is_rabu&&n.push("Rab"),a.is_kamis&&n.push("Kam"),a.is_jumat&&n.push("Jum"),a.is_sabtu&&n.push("Sab"),a.is_minggu&&n.push("Min"),n.length>0?n.join(", "):"Tidak ada jadwal"},{data:p={data:[],total:0},isLoading:j,isError:w}=A({queryKey:["karyawan",r],queryFn:async()=>(await d.get(`/api/admin/karyawan?page=${r}&limit=${h}`)).data,keepPreviousData:!0}),o=()=>g.invalidateQueries(["karyawan",r]),N=async()=>{try{const a=await d.get("/api/admin/shift");y(a.data.data)}catch(a){console.error("Gagal ambil shift",a)}};l.useEffect(()=>{N()},[]);const k=a=>{i({...a}),c(!0)},v=async a=>{a.preventDefault();try{await d.put(`/api/admin/karyawan/${t.id_akun}`,t),s.fire("‚úÖ Berhasil","Data karyawan berhasil diperbarui","success"),c(!1),o()}catch{s.fire("‚ùå Gagal","Gagal memperbarui data karyawan","error")}},_=async a=>{if((await s.fire({title:"Non-aktifkan Karyawan?",text:"Karyawan tidak akan bisa login, namun data presensi tetap aman.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#6c757d",confirmButtonText:"Ya, Non-aktifkan!",cancelButtonText:"Batal"})).isConfirmed)try{await d.delete(`/api/admin/karyawan/${a}`),s.fire("Berhasil!","Akun karyawan telah dinonaktifkan.","success"),o()}catch(m){console.error(m),s.fire("Gagal","Terjadi kesalahan saat menonaktifkan akun.","error")}},K=async a=>{if((await s.fire({title:"Aktifkan Kembali?",text:"Karyawan akan dapat login dan melakukan presensi lagi.",icon:"question",showCancelButton:!0,confirmButtonColor:"#10B981",cancelButtonColor:"#6c757d",confirmButtonText:"Ya, Aktifkan!",cancelButtonText:"Batal"})).isConfirmed)try{await d.put(`/api/admin/karyawan/${a}`,{status_akun:"AKTIF"}),s.fire("Berhasil!","Akun karyawan kembali AKTIF.","success"),o()}catch(m){console.error(m),s.fire("Gagal","Gagal mengaktifkan kembali akun.","error")}};return e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"üë• Kelola Data Karyawan"}),e.jsx("p",{className:"text-gray-600",children:"Admin dapat menambah, mengedit, dan menghapus akun karyawan di perusahaan Anda."}),e.jsxs("div",{className:"bg-white p-6 mt-4 rounded-lg shadow transition-transform duration-200 hover:shadow-lg",children:[e.jsxs("div",{className:"flex justify-between mb-4 items-center",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Daftar Karyawan"}),e.jsx("button",{onClick:o,className:"bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 active:scale-95 transition-all",children:"üîÑ Refresh"})]}),j?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"‚è≥ Memuat data..."}):w?e.jsx("p",{className:"text-red-500 text-center py-4",children:"‚ùå Gagal memuat data"}):e.jsxs("table",{className:"min-w-full border text-sm rounded-lg overflow-hidden",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2 border",children:"Nama"}),e.jsx("th",{className:"p-2 border",children:"Email"}),e.jsx("th",{className:"p-2 border",children:"Jabatan"}),e.jsx("th",{className:"p-2 border",children:"Shift"}),e.jsx("th",{className:"p-2 border",children:"Hari Kerja"}),e.jsx("th",{className:"p-2 border",children:"Aksi"})]})}),e.jsx("tbody",{children:p.data?.map(a=>e.jsxs("tr",{className:a.status_akun==="NONAKTIF"?"bg-gray-200 text-gray-500":"hover:bg-indigo-50",children:[e.jsxs("td",{className:"border p-2",children:[a.username,a.status_akun==="NONAKTIF"&&e.jsx("span",{className:"ml-2 text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded-full",children:"Non-Aktif"})]}),e.jsx("td",{className:"border p-2",children:a.username}),e.jsx("td",{className:"border p-2",children:a.email}),e.jsx("td",{className:"border p-2",children:a.id_jabatan}),e.jsx("td",{className:"border p-2",children:a.shift?`${a.shift.nama_shift} (${a.shift.jam_masuk}-${a.shift.jam_pulang})`:"-"}),e.jsx("td",{className:"border p-2 text-xs text-gray-600",children:a.shift?x(a.shift):"-"}),e.jsx("td",{className:"border p-2 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>k(a),className:"bg-yellow-400 px-3 py-1 rounded text-white hover:bg-yellow-500 transition-all text-xs",title:"Edit Data",children:"‚úèÔ∏è Edit"}),a.status_akun!=="NONAKTIF"?e.jsx("button",{onClick:()=>_(a.id_akun),className:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 transition-all text-xs",title:"Non-aktifkan Akun",children:"üõë Non-aktifkan"}):e.jsx("button",{onClick:()=>K(a.id_akun),className:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600 transition-all text-xs",title:"Aktifkan Kembali",children:"‚úÖ Aktifkan"})]})})]},a.id_akun))})]}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-2",children:[e.jsx("button",{disabled:r===1,onClick:()=>u(r-1),className:"bg-gray-200 px-3 py-1 rounded disabled:opacity-50 hover:bg-gray-300 active:scale-95 transition-all",children:"‚óÄÔ∏è Sebelumnya"}),e.jsxs("span",{className:"px-3 py-1",children:["Halaman ",r]}),e.jsx("button",{disabled:p.data?.length<h,onClick:()=>u(r+1),className:"bg-gray-200 px-3 py-1 rounded disabled:opacity-50 hover:bg-gray-300 active:scale-95 transition-all",children:"Berikutnya ‚ñ∂Ô∏è"})]})]}),b&&t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96 animate-fadeIn",children:[e.jsx("h3",{className:"font-bold mb-3 text-lg",children:"‚úèÔ∏è Edit Karyawan"}),e.jsxs("form",{onSubmit:v,className:"space-y-3",children:[e.jsx("input",{name:"username",value:t.username,onChange:a=>i({...t,username:a.target.value}),placeholder:"Nama Karyawan",className:"w-full border p-2 rounded",required:!0}),e.jsx("input",{name:"email",value:t.email,onChange:a=>i({...t,email:a.target.value}),placeholder:"Email",className:"w-full border p-2 rounded",required:!0}),e.jsx("input",{name:"no_tlp",value:t.no_tlp||"",onChange:a=>i({...t,no_tlp:a.target.value}),placeholder:"No. Telepon",className:"w-full border p-2 rounded"}),e.jsx("input",{name:"alamat_karyawan",value:t.alamat_karyawan||"",onChange:a=>i({...t,alamat_karyawan:a.target.value}),placeholder:"Alamat",className:"w-full border p-2 rounded"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pilih Shift Kerja"}),e.jsxs("select",{name:"id_shift",value:t.id_shift||"",onChange:a=>i({...t,id_shift:a.target.value}),className:"border p-2 rounded w-full text-sm",children:[e.jsx("option",{value:"",children:"-- Pilih Shift --"}),f.map(a=>e.jsxs("option",{value:a.id_shift,children:[a.nama_shift," (",a.jam_masuk,"-",a.jam_pulang,") ‚Äî ",x(a)]},a.id_shift))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"*Format: Nama (Jam) ‚Äî Hari Kerja"})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-3 py-1 bg-gray-300 rounded hover:bg-gray-400 active:scale-95 transition-all",children:"Batal"}),e.jsx("button",{type:"submit",className:"px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700 active:scale-95 transition-all",children:"Simpan"})]})]})]})})]})}export{B as default};
